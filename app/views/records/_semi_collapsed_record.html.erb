<div class="bg-white p-4 rounded-lg shadow-md mb-2" data-pgc-define="jr.record_semicollapsed" data-pgc-define-name="Record" data-pgc-section="Page components">
  <div class="flex justify-between items-center">
    <div class="flex items-center space-x-2">
      <%= group_item.check_box class: "form-checkbox text-indigo-600 h-5 w-5" %>
      <div>
        <h5 class="text-lg font-semibold text-gray-800">
          <%= link_to record.name, record_path(record) %>
        </h5>
        <%= render "shared/created_by", user: record.user %>
      </div>
    </div>
    <div class="flex items-center space-x-1">
      <!-- Chevron icons -->
      <i class="fas fa-chevron-up text-gray-400 hover:text-gray-600 cursor-pointer"></i>
      <i class="fas fa-chevron-down text-gray-400 hover:text-gray-600 cursor-pointer"></i>
      <!-- Star icon, active if bookmarked -->
      <% if user_signed_in? %>
        <% if current_user.bookmarked?(record) %>
          <i class="fas fa-star text-yellow-400 hover:text-yellow-500 cursor-pointer"></i>
        <% else %>
          <i class="far fa-star text-gray-400 hover:text-gray-600 cursor-pointer"></i>
        <% end %>
      <% end %>
    </div>
  </div>
  <div class="mt-4 space-y-2">
    <!-- URL and buttons -->
    <div class="flex items-center space-x-2">
      <span class="text-sm font-medium text-gray-700">URL:</span>
      <input type="text" class="form-input block w-full text-sm border-gray-300 rounded-md" value="<%= record_url(record) %>">
      <button class="px-2 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 focus:outline-none">
        <i class="fa fa-copy mr-1"></i>Copy
      </button>
      <%= link_to record_path(record), class: 'px-2 py-1 text-sm bg-blue-500 text-white rounded hover:bg-blue-600 focus:outline-none' do %>
        <i class="fa fa-eye mr-1"></i>Show
      <% end %>
    </div>
    <!-- Bookmark toggle -->
    <% if user_signed_in? %>
      <% bookmark = current_user.bookmarks.find_by(record: record) %>
      <% if bookmark %>
        <%= link_to record_bookmark_path(bookmark), method: :delete, class: 'text-yellow-400 hover:text-yellow-500' do %>
          <i class="fas fa-star"></i> Remove from Favourites
        <% end %>
      <% else %>
        <%= link_to record_bookmarks_path(record_id: record.id), method: :post, class: 'text-gray-400 hover:text-gray-600' do %>
          <i class="far fa-star"></i> Add to Favourites
        <% end %>
      <% end %>
    <% end %>

    <!-- Record details and actions -->
    <div class="flex justify-between items-center">
      <div class="w-2/3 space-y-2">
        <% record.dots.each do |dot| %>
          <p class="text-sm text-gray-700"><%= dot.description %></p>
        <% end %>
        <div class="w-full bg-gray-200 rounded-full h-2.5 dark:bg-gray-700">
          <div class="bg-blue-600 h-2.5 rounded-full" style="width: <%= record.progress_cached %>%;"></div>
        </div>
        <p class="text-sm text-gray-600">Completed: <%= record.progress_cached %>%</p>
      </div>
      <div class="w-1/3 flex flex-col space-y-2">
        <% #= link_to new_record_connection_type_connection_path(record_id: record.id, connection_type_id: @solution_connection_type_id), class: "px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 focus:outline-none" do %>
          <!--i class="fa fa-arrow-circle-left mr-1"></i> Can't solve due to another record-->
        <% #end %>
        <%= link_to new_record_connection_type_connection_path(record, @irrelevant_because_connection_type), class: "px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 focus:outline-none" do %>
          <i class="fa fa-arrow-circle-left mr-1"></i> Solved once you solve something else
        <% end %>
        <%= link_to new_record_connection_type_connection_path(record, @irrelevant_because_connection_type), class: "px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 focus:outline-none" do %>
          <i class="fa fa-close mr-1"></i> Irrelevant / Can't solve due to another record
        <% end %>
        <%= link_to new_record_dot_path(record_id: record.id, parent_id: nil), class: "px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 focus:outline-none" do %>
          <i class="fa fa-repeat mr-1"></i> Repeated
        <% end %>
        <%= link_to new_record_connection_type_record_type_bulk_record_path(record_id: record.id, connection_type_id: @solution_connection_type_id, record_type_id: @solution_record_type_id), class: "px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 focus:outline-none" do %>
          <i class="fa fa-check mr-1"></i> Create Solutions
        <% end %>
        <%= link_to new_record_connection_type_record_type_bulk_record_path(record_id: record.id, connection_type_id: @subsystem_connection_type_id, record_type_id: @subsystem_record_type_id), class: "px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 focus:outline-none" do %>
          <i class="fa fa-puzzle-piece mr-1"></i> Split
        <% end %>
        <%= link_to new_record_connection_type_record_type_bulk_record_path(record_id: record.id, connection_type_id: @subsystem_connection_type_id, record_type_id: @subsystem_record_type_id), class: "px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 focus:outline-none" do %>
          <i class="fa fa-puzzle-piece mr-1"></i> Create / Connect Subrecords
        <% end %>
        <%= link_to into_separate_project_record_connection_type_connections_path(record, @extracted_to_connection_type), method: :post, class: "px-2 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300 focus:outline-none" do %>
          <i class="fa fa-angle-double-up mr-1"></i> Extract Into Separate Project
        <% end %>
      </div>
    </div>
  </div>
</div>
